<app-template>
  <!--Zone de la navbar -->
  <app-home-button></app-home-button>
  <app-medium-button class="navbar-button" [routerLink]="['/ergo-config-selected']" routerLinkActive="active">
    <p class="name">
        <app-user-card [user]="selectedUser" class="horizontal navbar"/>
    </p>
  </app-medium-button>
  <app-medium-button class="navbar-button red" [routerLink]="['/ergo-play']"> Retour </app-medium-button>
  <app-medium-button class="navbar-button" [routerLink]="['/ergo-stat-selected']"> Statistiques </app-medium-button>




  <!--Zone du main -->
  <app-inner-box class="main-box blue">
    <!-- Save confirmation message -->
    <div class="save-confirmation-container">
      <div class="save-confirmation" *ngIf="saveConfirmationVisible">
        Configuration sauvegardée automatiquement a chaque modification.
      </div>
    </div>

    <span>NOM : {{ selectedUser?.name }}</span>
    <span>Âge : {{selectedUser?.age}} ans</span>
    <span>Troubles: {{selectedUser?.conditions}} </span>



    <div class="config-item operation-selector">
      <h3>Opérations</h3>

      <!-- Selected operations pills (similar to ergo-input-child-page) -->
      <div class="selected-operations" *ngIf="getSelectedOperations().length > 0">
        <div *ngFor="let operation of getSelectedOperations()" class="operation-pill">
          {{getOperationLabel(operation)}}
          <span class="remove-operation" (click)="toggleOperation(operation)">×</span>
        </div>
      </div>

      <!-- Dropdown for operations -->
      <div class="dropdown-wrapper">
        <select #operationSelect class="operations-dropdown" (change)="handleOperationSelection(operationSelect.value)">
          <option value="" disabled selected>Sélectionner une opération</option>
          <option *ngFor="let op of availableOperations"
                  [value]="op.key"
                  [disabled]="isOperationSelected(op.key)">
            {{op.label}}
          </option>
        </select>
      </div>
    </div>

    <!-- Settings in columns -->
    <div class="settings-columns">
      <!-- Column 1 -->
      <div class="settings-column">
        <!-- Rewrite toggle -->
        <div class="toggle-row">
          <span class="toggle-label">Réécrire</span>
          <app-settings-toggle
            [checked]="currentConfig.rewrite"
            (valueChange)="onToggleChange('rewrite', $event)">
          </app-settings-toggle>
        </div>

        <!-- Encryption toggle -->
        <div class="toggle-row">
          <span class="toggle-label">Chiffrement</span>
              <app-settings-toggle
                [checked]="currentConfig.encryption"
                (valueChange)="onToggleChange('encryption', $event)">
              </app-settings-toggle>
        </div>

        <!-- Show Answers toggle -->
        <div class="toggle-row">
          <span class="toggle-label">Montrer les réponses</span>
              <app-settings-toggle
                [checked]="currentConfig.showsAnswer"
                (valueChange)="onToggleChange('showsAnswer', $event)">
              </app-settings-toggle>
        </div>
          <!-- Word toggle -->
        <div class="toggle-row">
          <span class="toggle-label">Mot français</span>
          <app-settings-toggle
            [checked]="currentConfig.word"
            (valueChange)="onToggleChange('word', $event)">
          </app-settings-toggle>
        </div>
      </div>

      <!-- Column 2 -->
      <div class="settings-column">
        <!-- Additional features -->
      </div>
    </div>
  </app-inner-box>
</app-template>
